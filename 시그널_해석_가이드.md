# 기술적 시그널 해석 가이드

**파일**: `태은이를_위한_사랑의_템플릿_v2.ipynb`
**작성일**: 2026-02-11
**참고 문서**: `기술적지표일람.docx` (차트의 정석 기반)

---

## 1. 자기 평가: docx 지표 반영 현황

### 반영 완료 (시그널 의사결정에 포함: 13/20)

| # | docx 지표 | 코드 구현 | 시그널 분류 | 비고 |
|:-:|----------|:---------:|:----------:|------|
| 18 | DMI/ADX | O | **O** | +DI/-DI 교차 + ADX 25 기준 |
| 19 | CCI | O | **O** | ±100 기준 과매수/과매도 |
| 20 | MACD | O | **O** | 시그널 교차(히스토그램 부호 전환) |
| 21 | SONAR | O | **O** | 0선 기준 모멘텀 방향 (신규 추가) |
| 22 | ATR | O | **O** (중립) | 방향성 없음 → 항상 neutral |
| 23 | Chaikin Vol | O | **O** (중립) | 변동성 확대/축소 판단 (신규 추가) |
| 24 | Stochastic | O | **O** | 80/20 기준 |
| 25 | RSI | O | **O** | 70/30 기준 |
| 26 | Williams %R | O | **O** | -20/-80 기준 |
| 13 | Bollinger | O | **O** | %B 기준 (0/1 돌파, 0.2/0.8 근접) |
| 27 | OBV | O | **O** | 20일 MA 대비 방향 |
| 28 | A/D Line | O | **O** | 20일 MA 대비 매집/분산 (신규 추가) |
| 29 | CMF | O | **O** | ±0.1 기준 유입/유출 |

### 차트 표시만 (시그널 없음: 0/20 → 모두 해소)

이전에 누락되었던 SONAR, Chaikin Vol, A/D Line이 모두 시그널 분류에 추가되었습니다.

### 미구현 (데이터 부족: 7/20)

| # | docx 지표 | 미구현 사유 |
|:-:|----------|-----------|
| 10 | SMA/EMA | 가격지표 — 오버레이 전용, 단독 시그널 생성 부적절 |
| 11 | VWMA | 동상 |
| 12 | 일목균형표 | 오버레이 전용. 구름 돌파 시그널 미구현 |
| 14 | DEMA | 오버레이 전용 |
| 15 | Parabolic SAR | 오버레이 전용. SAR 반전 시그널 미구현 |
| 16 | T3 | 오버레이 전용 |
| 17 | VIDYA | 오버레이 전용 |

### 미구현 (개별 종목 분석 불가: 3/32)

| # | docx 지표 | 미구현 사유 |
|:-:|----------|-----------|
| 30 | 등락주선 (AD Line) | 업종 데이터(상승/하락 종목수) 필요 |
| 31 | TRIN | 업종 데이터 필요 |
| 32 | McClellan | 업종 데이터 필요 |

### 특수차트 (시각화 전용: 9종)

| # | 차트 | 구현 | 시그널 생성 |
|:-:|------|:---:|:---------:|
| 1 | 캔들차트 | O | X (시각화 전용) |
| 2 | 라인차트 | O | X |
| 3 | 바차트 | X (캔들로 대체) |
| 4 | P&F | O | X |
| 5 | 매물대차트 | O | X |
| 6 | 삼선전환도 | O | X |
| 7 | 역시계곡선 | O | X |
| 8 | 캔들볼륨 | O | X |
| 9 | 마켓프로파일 | X (틱 데이터 없음) |

### 종합 평가

**시그널 반영률**: 13/20 산출가능 지표 중 13개 반영 (65%)

**해소된 누락** (2026-02-11 업데이트):
- **SONAR**: 0선 기준 모멘텀 방향 시그널 추가
- **Chaikin Vol**: 변동성 확대/축소 정보 제공 (중립 시그널)
- **A/D Line**: 20일 MA 대비 매집/분산 시그널 추가

**잔여 미구현**:
- **일목균형표**: 구름 돌파/이탈 시그널 미구현 (오버레이만)
- **Parabolic SAR**: SAR 반전 시그널 미구현 (오버레이만)

**강점**:
- 채권 관점 방향 반전이 모든 시그널에 일관되게 적용됨
- 다이버전스 감지(RSI, MACD, CCI, Stoch, Williams, OBV, SONAR, A/D Line)
- 백분위 기반 상대 게이지 (`scipy.stats.percentileofscore` 사용)
- 방향 화살표가 시그널 맥락을 반영 (반전 지표 대응)

**개선 이력**:
- v1: 10/20 지표 반영, 단순 백분위 계산
- v2 (현재): 13/20 지표 반영, `percentileofscore(kind='rank')` 사용, 방향-시그널 정합성 수정

---

## 2. 시그널 시스템 구조

### 2.1 데이터 흐름

```
Cell 0: ExecutionConfig (설정)
  ↓
Cell 1: SignalClassifier + IndicatorConfig (엔진 정의)
  ↓
Cell 4: indicators = engine.compute_all(ohlcv_df)  (지표 계산)
  ↓
Cell 5: signals = classifier.classify_all(indicators, close)  (시그널 분류)
  ↓
Cell 5: composite = classifier.composite_score(signals)  (종합 스코어)
```

### 2.2 IndicatorSignal 구조

각 지표는 다음 필드를 가진 `IndicatorSignal` 객체로 변환됩니다:

| 필드 | 타입 | 설명 |
|------|------|------|
| `name` | str | 지표명 (예: 'RSI', 'MACD') |
| `category` | str | 카테고리 ('trend', 'momentum', 'volatility', 'volume') |
| `value` | float | 현재 지표값 |
| `signal` | str | **'buy' / 'sell' / 'neutral' / 'n/a'** |
| `description` | str | 한글 설명 (예: '72.1 금리과매수→매수') |
| `abs_gauge` | float | 이론적 범위 내 위치 (0.0~1.0) |
| `rel_gauges` | dict | 기간별 백분위 {'full', 'short', 'medium', 'long'} |
| `direction` | str | 전일 대비 변화 ('strengthening'/'weakening'/'stable') |
| `divergence` | bool | 가격과의 다이버전스 여부 |

### 2.3 채권 방향 반전 규칙

**핵심 원칙**: 이 노트북은 **금리(수익률)** 데이터를 분석합니다.
- 금리 상승 = 채권 가격 하락 = **매도**
- 금리 하락 = 채권 가격 상승 = **매수**

따라서 전통적인 주식 시그널과 **정반대**입니다:

| 상황 | 주식에서 | 이 노트북에서 (채권) | 이유 |
|------|---------|-------------------:|------|
| RSI > 70 | 매도 (과매수) | **매수** | 금리 과매수 → 곧 하락 → 채권 상승 |
| RSI < 30 | 매수 (과매도) | **매도** | 금리 과매도 → 곧 상승 → 채권 하락 |
| MACD 골든크로스 | 매수 | **매도** | 금리 상승 추세 → 채권 하락 |
| MACD 데드크로스 | 매도 | **매수** | 금리 하락 추세 → 채권 상승 |

---

## 3. 지표별 시그널 판정 기준과 해석 예시

### 3.1 RSI (Relative Strength Index)

**분류 함수**: `classify_rsi()`

**판정 기준**:
| 조건 | 시그널 | 설명 |
|------|--------|------|
| RSI > 70.0 | **매수** | 금리가 과매수 → 조만간 하락 → 채권 매수 기회 |
| RSI < 30.0 | **매도** | 금리가 과매도 → 조만간 상승 → 채권 매도 기회 |
| 30 ≤ RSI ≤ 70 | 중립 | 추세 판단 보류 |

**설정 위치**: Cell 0 `IndicatorConfig`
```python
rsi_overbought: float = 70.0   # 이 값 이상이면 매수 시그널
rsi_oversold: float = 30.0     # 이 값 이하이면 매도 시그널
rsi_period: int = 14            # RSI 계산 기간
```

**해석 예시**:
- **RSI = 75.3** → 시그널: `매수`, 설명: "75.3 금리과매수→매수"
  - 의미: 최근 14일간 금리가 급격히 상승(채권 급락). 역사적으로 이 수준에서 금리 반락이 빈번하므로 채권 매수 관점.
- **RSI = 45.0** → 시그널: `중립`, 설명: "45.0 중립"
  - 의미: 금리의 상승/하락 압력이 균형. 관망.
- **RSI = 22.8** → 시그널: `매도`, 설명: "22.8 금리과매도→매도"
  - 의미: 금리가 과도하게 하락(채권 과매수). 반등 리스크. 채권 매도/차익실현 관점.

**백분위 해석**:
- 지정기간 83% → 현재 RSI값이 분석 전체 기간 중 상위 17%에 위치 (금리 과열 상태가 매우 극단적)
- 단기(20d) 62% → 최근 20일 중에서는 중상위권 (단기적으로도 높은 편)
- 장기(250d) 71% → 1년 기준으로도 높은 편

**다이버전스**:
- RSI 하락 + 금리 상승 → **베어리시 다이버전스** (금리 상승 탄력 둔화, 반락 가능성 ↑)
- RSI 상승 + 금리 하락 → **불리시 다이버전스** (금리 하락 탄력 둔화, 반등 가능성 ↑)

---

### 3.2 MACD (Moving Average Convergence Divergence)

**분류 함수**: `classify_macd()`

**판정 기준** (히스토그램 = MACD - Signal 기준):
| 조건 | 시그널 | 설명 |
|------|--------|------|
| 히스토그램 < 0 (직전 ≥ 0) | **매수** | 데드크로스 발생 (금리 하락 전환) |
| 히스토그램 > 0 (직전 ≤ 0) | **매도** | 골든크로스 발생 (금리 상승 전환) |
| 히스토그램 < 0 (지속) | **매수** | 금리 하락 추세 지속 |
| 히스토그램 > 0 (지속) | **매도** | 금리 상승 추세 지속 |

**설정 위치**: Cell 0 `IndicatorConfig`
```python
macd_fast: int = 12     # 단기 EMA
macd_slow: int = 26     # 장기 EMA
macd_signal: int = 9    # 시그널 EMA
```

**해석 예시**:
- **MACD=-0.0312, 히스토그램 부호 전환(+→-)** → 시그널: `매수`, 설명: "-0.0312 데드크로스"
  - 의미: 단기 금리 이동평균이 장기를 하향 돌파. 금리 하락 추세 시작 → 채권 매수.
- **MACD=+0.0150, 히스토그램 > 0 지속** → 시그널: `매도`, 설명: "+0.0150 상승추세"
  - 의미: 금리 상승 추세 지속 중. 채권 약세 전망.

**참고**: MACD의 `abs_gauge`는 항상 0.5 (절대 위치 판단이 의미 없음). `rel_gauges`의 백분위가 핵심.

---

### 3.3 DMI (Directional Movement Index) & ADX

**분류 함수**: `classify_dmi()`

**판정 기준**:
| 조건 | 시그널 | 설명 |
|------|--------|------|
| -DI > +DI **AND** ADX > 25 | **매수** | 금리 하락 추세 확인 (강한 추세) |
| +DI > -DI **AND** ADX > 25 | **매도** | 금리 상승 추세 확인 (강한 추세) |
| ADX ≤ 25 | 중립 | 추세 없음 (횡보) |

**설정 위치**: ADX 25 임계값은 코드에 하드코딩 (`classify_dmi()` 내부)

**해석 예시**:
- **+DI=18, -DI=32, ADX=28** → 시그널: `매수`, 설명: "ADX 28 금리하락추세"
  - 의미: -DI(하향 방향)가 지배적이며 ADX가 25를 넘어 추세가 유의미. 금리 하락세 확인 → 채권 매수.
- **+DI=25, -DI=22, ADX=15** → 시그널: `중립`, 설명: "ADX 15 비추세"
  - 의미: ADX 15는 추세가 약함. +DI가 약간 높지만 신뢰 불가 → 관망.

---

### 3.4 CCI (Commodity Channel Index)

**분류 함수**: `classify_cci()`

**판정 기준**:
| 조건 | 시그널 | 설명 |
|------|--------|------|
| CCI > +100 | **매수** | 금리 과매수 → 하락 반전 예상 |
| CCI < -100 | **매도** | 금리 과매도 → 상승 반전 예상 |
| -100 ≤ CCI ≤ +100 | 중립 | 정상 범위 |

**설정 위치**: Cell 0 `IndicatorConfig`
```python
cci_overbought: float = 100.0
cci_oversold: float = -100.0
cci_period: int = 20
```

**해석 예시**:
- **CCI = +145** → 시그널: `매수`, 설명: "145 금리과매수→매수"
  - 의미: 금리가 이동평균 대비 과도하게 높음 → 평균회귀 기대 → 채권 매수.
- **CCI = -52** → 시그널: `중립`, 설명: "-52 중립"
  - 의미: 정상 범위 내. 특별한 시그널 없음.

---

### 3.5 Stochastic (%K, %D)

**분류 함수**: `classify_stochastic()`

**판정 기준** (%K 기준):
| 조건 | 시그널 | 설명 |
|------|--------|------|
| %K > 80 | **매수** | 금리가 최근 범위 상단 → 하락 반전 예상 |
| %K < 20 | **매도** | 금리가 최근 범위 하단 → 상승 반전 예상 |
| 20 ≤ %K ≤ 80 | 중립 | 중간 영역 |

**설정 위치**: Cell 0 `IndicatorConfig`
```python
stoch_overbought: float = 80.0
stoch_oversold: float = 20.0
stoch_k: int = 14
stoch_d: int = 3
stoch_smooth: int = 3
```

**해석 예시**:
- **%K = 88** → 시그널: `매수`, 설명: "%K=88 금리과매수"
  - 의미: 최근 14일 금리 범위에서 현재 금리가 상단 88% 위치. 과열 → 금리 하락 예상 → 채권 매수.
- **%K = 12** → 시그널: `매도`, 설명: "%K=12 금리과매도"
  - 의미: 금리가 최근 범위 하단. 반등 예상 → 채권 매도.

---

### 3.6 Williams %R

**분류 함수**: `classify_williams()`

**판정 기준**:
| 조건 | 시그널 | 설명 |
|------|--------|------|
| %R > -20 | **매수** | 금리 과매수 (천정 근처) |
| %R < -80 | **매도** | 금리 과매도 (바닥 근처) |
| -80 ≤ %R ≤ -20 | 중립 | 중간 영역 |

**설정 위치**: Cell 0 `IndicatorConfig`
```python
williams_overbought: float = -20.0
williams_oversold: float = -80.0
williams_period: int = 14
```

**해석 예시**:
- **%R = -8** → 시그널: `매수`, 설명: "-8 금리과매수→매수"
  - 의미: 금리가 최근 최고가에 거의 도달. 천정 압력 → 하락 전환 예상 → 채권 매수.

---

### 3.7 Bollinger Band (%B)

**분류 함수**: `classify_bollinger()`

**판정 기준** (%B = 밴드 내 위치, 0=하한, 1=상한):
| 조건 | 시그널 | 설명 |
|------|--------|------|
| %B > 1.0 | **매수** | 금리가 상한선 돌파 → 극단적 과매수 |
| %B > 0.8 | **매수** | 금리가 상한 근접 |
| %B < 0.0 | **매도** | 금리가 하한선 돌파 → 극단적 과매도 |
| %B < 0.2 | **매도** | 금리가 하한 근접 |
| 0.2 ≤ %B ≤ 0.8 | 중립 | 밴드 내 정상 범위 |

**설정 위치**: Cell 0 `IndicatorConfig`
```python
bb_period: int = 20
bb_std: float = 2.0
```
%B 임계값(0.0, 0.2, 0.8, 1.0)은 `classify_bollinger()` 내부에 하드코딩.

**해석 예시**:
- **%B = 1.15** → 시그널: `매수`, 설명: "%B=1.15 상한돌파→매수"
  - 의미: 금리가 볼린저 상한선(+2σ)을 넘어섬. 통계적 극단 → 평균회귀(금리 하락) 예상 → 채권 매수.
- **%B = 0.45** → 시그널: `중립`, 설명: "%B=0.45 중립"
  - 의미: 밴드 중앙 부근. 특이 사항 없음.

---

### 3.8 ATR (Average True Range)

**분류 함수**: `classify_atr()`

**판정 기준**:
| 조건 | 시그널 | 설명 |
|------|--------|------|
| (항상) | **중립** | 방향성 없는 변동성 지표 |

**설명**: ATR은 변동성의 크기만 측정하며 방향성이 없으므로 매수/매도 시그널을 생성하지 않습니다. 다만 백분위 게이지를 통해 현재 변동성이 역사적으로 어느 수준인지 파악할 수 있습니다.

**해석 예시**:
- **ATR = 0.0285** → 시그널: `중립`, 설명: "0.0285 고변동"
  - 의미: 현재 일평균 변동폭이 2.85bp. 75% 분위 이상이면 "고변동" 표시.
  - 활용: 고변동 시 포지션 사이즈 축소 또는 손절 폭 확대 검토.

---

### 3.9 OBV (On Balance Volume)

**분류 함수**: `classify_obv()`

**판정 기준**:
| 조건 | 시그널 | 설명 |
|------|--------|------|
| OBV > 20일 MA | **매도** | OBV 상승 = 금리 상승세에 거래량 실림 |
| OBV < 20일 MA | **매수** | OBV 하락 = 금리 하락세에 거래량 실림 |

**해석 예시**:
- **OBV = 125,000 (20일 MA = 118,000)** → 시그널: `매도`, 설명: "상승 추세"
  - 의미: 누적 거래량이 상승 방향. 금리 상승에 거래량이 뒷받침됨 → 채권 약세.
- **OBV-금리 다이버전스**: OBV 하락 + 금리 상승 → 금리 상승 에너지 고갈 → 반락 기대.

---

### 3.10 CMF (Chaikin Money Flow)

**분류 함수**: `classify_cmf()`

**판정 기준**:
| 조건 | 시그널 | 설명 |
|------|--------|------|
| CMF > +0.10 | **매도** | 강한 자금 유입 (금리 관점: 상승 압력) |
| 0 < CMF ≤ +0.10 | 중립 | 약한 유입 |
| -0.10 ≤ CMF < 0 | 중립 | 약한 유출 |
| CMF < -0.10 | **매수** | 강한 자금 유출 (금리 관점: 하락 압력) |

**설정 위치**: Cell 0 `IndicatorConfig`
```python
cmf_period: int = 21
```
임계값 ±0.10은 `classify_cmf()` 내부에 하드코딩.

**해석 예시**:
- **CMF = +0.18** → 시그널: `매도`, 설명: "+0.18 강한 유입"
  - 의미: 종가가 일일 범위 상단에서 마감되는 경향 + 거래량 유입. 금리 상승 지속 전망 → 채권 매도.
- **CMF = -0.23** → 시그널: `매수`, 설명: "-0.23 강한 유출"
  - 의미: 자금 유출 강함. 금리 하락 압력 → 채권 매수.

### 3.11 SONAR (신규)

**분류 함수**: `classify_sonar()`

**카테고리**: 추세 (trend)

| SONAR 값 | 시그널 | 설명 |
|:--------:|:------:|------|
| < 0 | 매수 | 금리 하락 모멘텀 → 채권 매수 |
| > 0 | 매도 | 금리 상승 모멘텀 → 채권 매도 |
| = 0 | 중립 | 모멘텀 전환 중 |

**방향 반전**: SONAR는 반전 지표 (값 상승 = 매도 방향)

**해석 예시**:
- **SONAR = -2.15** → 시그널: `매수`, 설명: "-2.15 하락모멘텀→매수"
  - 의미: 금리 하락 모멘텀이 활발. 채권 가격 상승 기대.

### 3.12 Chaikin Volatility (신규)

**분류 함수**: `classify_chaikin_vol()`

**카테고리**: 변동성 (volatility)

항상 `neutral` 시그널 반환 (방향성 없는 변동성 지표).
변동성 확대(>0.1) / 축소(<-0.1) / 보통 정보 제공.

### 3.13 A/D Line (신규)

**분류 함수**: `classify_ad_line()`

**카테고리**: 거래량 (volume)

| A/D Line 추세 | 시그널 | 설명 |
|:-------------:|:------:|------|
| 20일 MA 상회 (상승) | 매도 | 매집 → 금리 상승 압력 |
| 20일 MA 하회 (하락) | 매수 | 분산 → 금리 하락 압력 |

**방향 반전**: A/D Line은 반전 지표 (값 상승 = 매도 방향)

---

## 4. 종합 스코어 계산

**함수**: `composite_score()`

```
종합 스코어 = (매수 지표 수 - 매도 지표 수) / 유효 지표 수
```

| 스코어 범위 | 해석 |
|:-----------:|------|
| +0.60 ~ +1.00 | 강한 매수 (대부분 지표가 매수 시그널) |
| +0.20 ~ +0.59 | 약한 매수 |
| -0.19 ~ +0.19 | 중립 (혼조) |
| -0.59 ~ -0.20 | 약한 매도 |
| -1.00 ~ -0.60 | 강한 매도 |

**예시**: 유효 지표 8개 중 매수 5, 매도 1, 중립 2
→ 스코어 = (5 - 1) / 8 = **+0.50** (약한 매수)

**한계**: 모든 지표를 동일 가중으로 취급. 추세 지표와 모멘텀 지표의 가중치 차등 없음.

---

## 5. 백분위 게이지 시스템

### 5.1 계산 방법

각 지표에 대해 4개 기간의 백분위를 계산합니다:

| 게이지 | 기간 | 설정 | 의미 |
|--------|------|------|------|
| 지정기간 | 전체 데이터 | `start_date ~ end_date` | 전체 기간 대비 현재 위치 |
| 단기 | N일 | `CFG.gauge_short` (기본 20) | 단기 과열/침체 |
| 중기 | N일 | `CFG.gauge_medium` (기본 120) | 중기 추세 내 위치 |
| 장기 | N일 | `CFG.gauge_long` (기본 250) | 장기 추세 내 위치 |

**계산 공식**:
```
백분위 = (해당 기간 중 현재값보다 작은 값의 수) / (해당 기간의 총 데이터 수)
```

### 5.2 해석 규칙

| 백분위 | 색상 | 채권 관점 해석 |
|:------:|:----:|---------------|
| 0~30% | 녹색 | 금리가 해당 기간 하위권 → 채권 강세 영역 → **매수 유리** |
| 31~69% | 회색 | 중간 영역 → 추세 판단 보류 |
| 70~100% | 적색 | 금리가 해당 기간 상위권 → 채권 약세 영역 → **매도 유리** |

### 5.3 해석 예시

**RSI 백분위**:
| 기간 | 값 | 해석 |
|------|:--:|------|
| 지정기간(1506d) | 83% | 전체 기간 중 RSI가 상위 17% → 역사적으로 매우 높은 과매수 수준 |
| 단기(20d) | 62% | 최근 1개월 중 중상위 → 단기적으로도 높은 편 |
| 중기(120d) | 55% | 6개월 기준 중앙 부근 → 중기적으로는 특이 없음 |
| 장기(250d) | 71% | 1년 기준 상위 29% → 연간으로도 과매수 편향 |

**통합 해석**: 지정기간 83% + 장기 71% + 단기 62% → 모든 기간에서 RSI가 높은 편이므로 금리 과매수(=채권 매수) 시그널에 높은 신뢰도.

---

## 6. 설정 변경 가이드

### 6.1 시그널 임계값 변경 (Cell 0)

`IndicatorConfig` dataclass에서 직접 변경합니다:

```python
# 기본값 (보수적)
rsi_overbought = 70.0
rsi_oversold = 30.0

# 공격적으로 변경 (더 많은 시그널 생성)
rsi_overbought = 65.0
rsi_oversold = 35.0

# 보수적으로 변경 (극단적일 때만 시그널)
rsi_overbought = 80.0
rsi_oversold = 20.0
```

### 6.2 변경 가능한 임계값 목록

| 파라미터 | 기본값 | 위치 | 영향 |
|---------|:------:|:----:|------|
| `rsi_overbought` | 70 | Cell 0 IndicatorConfig | RSI 매수 시그널 기준 |
| `rsi_oversold` | 30 | Cell 0 IndicatorConfig | RSI 매도 시그널 기준 |
| `stoch_overbought` | 80 | Cell 0 IndicatorConfig | Stochastic 매수 기준 |
| `stoch_oversold` | 20 | Cell 0 IndicatorConfig | Stochastic 매도 기준 |
| `cci_overbought` | 100 | Cell 0 IndicatorConfig | CCI 매수 기준 |
| `cci_oversold` | -100 | Cell 0 IndicatorConfig | CCI 매도 기준 |
| `williams_overbought` | -20 | Cell 0 IndicatorConfig | Williams 매수 기준 |
| `williams_oversold` | -80 | Cell 0 IndicatorConfig | Williams 매도 기준 |

### 6.3 하드코딩된 임계값 (코드 수정 필요)

| 파라미터 | 기본값 | 위치 | 영향 |
|---------|:------:|:----:|------|
| DMI ADX 임계값 | 25 | Cell 1 `classify_dmi()` | 추세 유무 판별 기준 |
| Bollinger %B 임계값 | 0.0/0.2/0.8/1.0 | Cell 1 `classify_bollinger()` | BB 시그널 기준 |
| CMF 임계값 | ±0.10 | Cell 1 `classify_cmf()` | 자금흐름 시그널 기준 |
| OBV MA 기간 | 20 | Cell 1 `classify_obv()` | OBV 추세 판별 |
| 다이버전스 lookback | 20 | Cell 1 `_check_divergence()` | 다이버전스 감지 기간 |

### 6.4 백분위 게이지 기간 변경 (Cell 0)

```python
CFG = ExecutionConfig(
    gauge_short = 20,     # 기본: 20일 (약 1개월)
    gauge_medium = 120,   # 기본: 120일 (약 6개월)
    gauge_long = 250,     # 기본: 250일 (약 1년)
)
```

---

## 7. 지표 계산 파라미터 변경

| 지표 | 파라미터 | 기본값 | Cell 0 필드 |
|------|---------|:------:|------------|
| SMA | 기간 | 5,10,20,60,120 | `sma_periods` |
| Bollinger | 기간, 표준편차 | 20, 2.0 | `bb_period`, `bb_std` |
| MACD | 단기/장기/시그널 | 12/26/9 | `macd_fast/slow/signal` |
| RSI | 기간 | 14 | `rsi_period` |
| Stochastic | K/D/smooth | 14/3/3 | `stoch_k/d/smooth` |
| Williams %R | 기간 | 14 | `williams_period` |
| CCI | 기간 | 20 | `cci_period` |
| DMI/ADX | 기간 | 14 | `dmi_period` |
| ATR | 기간 | 14 | `atr_period` |
| Chaikin Vol | EMA/ROC | 10/10 | `chaikin_ema_period/roc_period` |
| CMF | 기간 | 21 | `cmf_period` |
| Ichimoku | 전환/기준/선행B | 9/26/52 | `ichimoku_tenkan/kijun/senkou_b` |
| Parabolic SAR | AF 초기/증분/최대 | 0.02/0.02/0.20 | `sar_af_init/step/max` |
| DEMA | 기간 | 20 | `dema_period` |
| T3 | 기간, v팩터 | 5, 0.7 | `t3_period`, `t3_vfactor` |
| VIDYA | 기간 | 20 | `vidya_period` |
| SONAR | 기간 | 14 | `sonar_period` |
| P&F | 박스, 반전 | 0.01, 3 | `pnf_box_size`, `pnf_reversal` |
| 삼선전환도 | 전환선 수 | 3 | `three_line_break_lines` |

---

## 8. 종합 시그널 읽기 체크리스트

실무에서 대시보드를 읽을 때 다음 순서를 권장합니다:

1. **종합 스코어 확인** → +0.3 이상이면 매수 편향, -0.3 이하면 매도 편향
2. **추세 지표 확인** (MACD, DMI) → 방향성 확인
3. **모멘텀 지표 확인** (RSI, Stoch) → 과매수/과매도 확인
4. **추세+모멘텀 일치 여부** → 둘 다 매수면 신뢰도 ↑, 불일치면 관망
5. **백분위 게이지** → 단기/장기 괴리가 크면 추세 전환 가능성
6. **다이버전스 [D] 마커** → 있으면 추세 반전 경고
7. **거래량 지표** (OBV, CMF) → 추세에 거래량이 뒷받침되는지 확인
8. **ATR** → 변동성 수준에 따라 포지션 사이즈 조절

**주의**: 이 시그널은 참고 지표이며, 매크로 환경(한은 기준금리, 국채 수급, 글로벌 금리)을 반드시 함께 고려해야 합니다.

---

## 9. 시그널 개선 제안

### 9.1 현재 구현의 한계

| 항목 | 현재 상태 | 개선 방안 |
|------|----------|----------|
| 종합 스코어 | 단순 (매수-매도)/유효 (동일 가중) | 가중 평균 도입 |
| 교차 확인 | 개별 지표 독립 판단 | 지표 간 확인(confirmation) 로직 |
| 시간 가중 | 없음 | 최근 시그널에 더 높은 가중치 |
| 신뢰도 | 없음 | 백분위 극단성 기반 신뢰도 점수 |
| 일목균형표 | 오버레이만 | 구름 돌파/이탈 시그널 추가 가능 |
| Parabolic SAR | 오버레이만 | SAR 반전 시그널 추가 가능 |

### 9.2 가중 종합 스코어 (제안)

현재 모든 지표에 동일 가중치(1.0)를 적용합니다. 아래와 같이 카테고리별 차등 가중을 적용하면 더 유의미한 종합 점수가 됩니다:

```python
# 예시 가중치 (합계 = 1.0 아님, 상대 비율로 적용)
SIGNAL_WEIGHTS = {
    # 추세 지표 (방향성 판단에 핵심)
    'MACD': 1.5, 'DMI': 1.3, 'CCI': 1.0, 'SONAR': 0.8,
    # 모멘텀 지표 (타이밍에 핵심)
    'RSI': 1.2, 'Stochastic': 1.0, 'Williams %R': 0.8,
    # 변동성 (보조)
    'Bollinger': 1.0, 'ATR': 0.3, 'Chaikin Vol': 0.3,
    # 거래량 (확인용)
    'OBV': 0.7, 'CMF': 0.7, 'A/D Line': 0.5,
}
```

**구현 방법**: `composite_score()` 함수 내에서 `{'buy': +weight, 'sell': -weight, 'neutral': 0}`으로 합산 후 정규화.

### 9.3 교차 확인 로직 (제안)

추세 지표와 모멘텀 지표가 동시에 같은 방향을 가리킬 때 시그널 신뢰도를 높입니다:

```
예시:
- MACD = 매수 + RSI = 매수 → "추세+모멘텀 동시 매수" (높은 신뢰도)
- MACD = 매수 + RSI = 매도 → "지표 불일치" (관망 권장)
- DMI = 매수 + OBV = 매수 → "추세+거래량 확인" (거래량 뒷받침)
```

### 9.4 백분위 기반 신뢰도 (제안)

백분위가 극단(0~20% 또는 80~100%)에 있을수록 시그널 신뢰도가 높습니다:

```
신뢰도 = max(|percentile - 0.5|, 0) / 0.5
- 백분위 5% → 신뢰도 0.90 (강한 매수 근거)
- 백분위 50% → 신뢰도 0.00 (중립, 시그널 무의미)
- 백분위 95% → 신뢰도 0.90 (강한 매도 근거)
```

### 9.5 방향 화살표 해석 (v2 업데이트)

v2에서 방향 화살표의 의미가 변경되었습니다:

| 화살표 | 의미 | 색상 |
|:------:|------|:----:|
| ▲ | 매수에 유리한 방향으로 이동 중 | 녹색 |
| ▼ | 매도에 유리한 방향으로 이동 중 | 적색 |
| - | 안정 (변화 미미) | 회색 |

**반전 지표 처리**: MACD, OBV, CMF, SONAR, A/D Line은 값 상승이 매도 방향을 의미하므로, 화살표 방향이 자동으로 반전됩니다. 예를 들어 MACD 히스토그램이 더 음(-)으로 갈 때 ▲(녹색)이 표시됩니다.
